# frozen_string_literal: true

module Tenable
  module Models
    # Represents a vulnerability finding from the Tenable.io API.
    class Vulnerability
      # @return [Integer, nil] the plugin ID
      attr_reader :plugin_id

      # @return [String, nil] the plugin name
      attr_reader :plugin_name

      # @return [String, nil] severity level (e.g., "high", "critical")
      attr_reader :severity

      # @return [Integer, nil] numeric severity identifier
      attr_reader :severity_id

      # @return [String, nil] vulnerability state (e.g., "open", "fixed")
      attr_reader :state

      # @return [Asset, nil] the associated asset
      attr_reader :asset

      # @return [String, nil] plugin output text
      attr_reader :output

      # @return [String, nil] ISO 8601 timestamp when first detected
      attr_reader :first_found

      # @return [String, nil] ISO 8601 timestamp when last detected
      attr_reader :last_found

      # @return [String, nil] ISO 8601 timestamp when last remediated
      attr_reader :last_fixed

      # @return [Float, nil] Vulnerability Priority Rating score
      attr_reader :vpr_score

      # @return [Float, nil] CVSS base score
      attr_reader :cvss_base_score

      # @return [Array<String>] associated CVE identifiers
      attr_reader :cve

      # @param data [Hash] raw API response hash
      def initialize(data)
        @plugin_id = data['plugin_id']
        @plugin_name = data['plugin_name']
        @severity = data['severity']
        @severity_id = data['severity_id']
        @state = data['state']
        @asset = data['asset'] ? Asset.new(data['asset']) : nil
        @output = data['output']
        @first_found = data['first_found']
        @last_found = data['last_found']
        @last_fixed = data['last_fixed']
        @vpr_score = data['vpr_score']
        @cvss_base_score = data['cvss_base_score']
        @cve = data['cve'] || []
      end
    end
  end
end
