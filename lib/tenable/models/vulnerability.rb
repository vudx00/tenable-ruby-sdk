# frozen_string_literal: true

module Tenable
  module Models
    class Vulnerability
      attr_reader :plugin_id, :plugin_name, :severity, :severity_id, :state,
                  :asset, :output, :first_found, :last_found, :last_fixed,
                  :vpr_score, :cvss_base_score, :cve

      def initialize(data)
        @plugin_id = data['plugin_id']
        @plugin_name = data['plugin_name']
        @severity = data['severity']
        @severity_id = data['severity_id']
        @state = data['state']
        @asset = data['asset'] ? Asset.new(data['asset']) : nil
        @output = data['output']
        @first_found = data['first_found']
        @last_found = data['last_found']
        @last_fixed = data['last_fixed']
        @vpr_score = data['vpr_score']
        @cvss_base_score = data['cvss_base_score']
        @cve = data['cve'] || []
      end
    end
  end
end
